{
  "controller_name": "MiniAppController",
  "description": "Handles all logic related to the Telegram Mini App, including a verification step, rendering the main app, and authenticating the user.",
  "methods": [
    {
      "name": "start",
      "description": "Acts as the initial entry point for the Mini App. It verifies the bot_id from the URL. If valid, it renders a temporary verification page that automatically redirects to the main app. Otherwise, it shows an error page.",
      "route": "GET /miniapp/start/{bot_id}",
      "parameters": [
        {
          "name": "bot_id",
          "type": "int",
          "description": "The Telegram Bot ID, passed from the URL."
        }
      ],
      "returns": "Renders a verification view (`views/miniapp/start.php`) or an error view."
    },
    {
      "name": "app",
      "description": "Renders the main Mini App page after the initial verification is complete. This page contains the primary UI and client-side logic.",
      "route": "GET /miniapp/app/{bot_id}",
      "parameters": [
        {
          "name": "bot_id",
          "type": "int",
          "description": "The Telegram Bot ID, passed from the URL."
        }
      ],
      "returns": "Renders the main application view (`views/miniapp/index.php`) within the Dashmix template."
    },
    {
      "name": "authenticate",
      "description": "API endpoint to securely authenticate a Mini App user. It validates the `initData` string from Telegram using the specific bot's token. Upon successful authentication, the user's data and role are stored in the session, accessible via the `Auth` helper.",
      "route": "POST /api/miniapp/auth",
      "parameters": [
        {
          "name": "initData",
          "type": "string",
          "in": "body",
          "description": "The raw `initData` string provided by the Telegram client."
        },
        {
          "name": "bot_id",
          "type": "int",
          "in": "body",
          "description": "The ID of the bot to use for validating the hash."
        }
      ],
      "returns": "A JSON response containing the authentication status and user data on success."
    }
  ]
}
