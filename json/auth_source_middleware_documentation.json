{
  "middleware_name": "AuthSourceMiddleware",
  "description": "Ensures that the authenticated user's session originated from one of the specified authentication sources (e.g., 'miniapp' or 'xoradmin'). This is used to restrict access to pages based on how the user logged in.",
  "constructor": {
    "parameters": [
      {
        "name": "requiredSources",
        "type": "array",
        "description": "An array of required authentication source strings (e.g., ['miniapp', 'xoradmin'])."
      }
    ]
  },
  "methods": [
    {
      "name": "handle",
      "description": "Processes the request. If the `auth_source` in the session does not match the `requiredSource`, it returns a 403 Forbidden error and exits. Otherwise, it calls the next handler in the pipeline.",
      "parameters": [
        {
          "name": "next",
          "type": "callable",
          "description": "The next middleware or request handler in the pipeline."
        }
      ],
      "returns": "mixed"
    }
  ]
}